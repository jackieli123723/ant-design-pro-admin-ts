### MOCK ok

lenovo@lenovo-PC MINGW64 /g/react/ant-design-pro (master)
$ yarn start
yarn run v1.10.1
$ umi dev
ğŸš€ Starting Umi UI using umi@3.2.0...
ğŸŒˆ Umi UI mini Ready on port 3000.
Starting the development server...
i Compiling Webpack
âˆš Webpack: Compiled successfully in 33.62s
 DONE  Compiled successfully in 33625ms10:10:22


  App running at:
  - Local:   http://localhost:8001 (copied to clipboard)
  - Network: http://172.16.210.111:8001

http://localhost:8001/api/login/account
{status: "error", type: "account", currentAuthority: "guest"}
{status: "ok", type: "account", currentAuthority: "admin"}


###
lenovo@lenovo-PC MINGW64 /g/react/ant-design-pro (master)
$ yarn start:no-mock
yarn run v1.10.1
$ cross-env MOCK=none umi dev
ğŸš€ Starting Umi UI using umi@3.2.0...
ğŸŒˆ Umi UI mini Ready on port 3000.
Starting the development server...
i Compiling Webpack
âˆš Webpack: Compiled successfully in 30.08s
 DONE  Compiled successfully in 30080ms10:01:32


## å¯åŠ¨ä¸Šé¢ä¸¤ä¸ª ç„¶åä¿®æ”¹ proxy.ts
  dev: {
    '/api/': {
      // target: 'https://preview.pro.ant.design',
      target: 'http://localhost:8001',
      changeOrigin: true,
      pathRewrite: { '^': '' },
    },


ç„¶åå¯ä»¥ç”¨ mockäº† 


## å®˜ç½‘ç¤ºä¾‹çš„è·¯ç”±é¡µé¢

http://github.com/ant-design/pro-blocks.git


lenovo@lenovo-PC MINGW64 /g/react/ant-design-pro (master)
$  npm run fetch:blocks
npm WARN npm npm does not support Node.js v12.8.1
npm WARN npm You should probably upgrade to a newer version of node as we
npm WARN npm can't make any promises that npm will work with this version.
npm WARN npm Supported releases of Node.js are the latest release of 6, 8, 9, 10, 11.
npm WARN npm You can find the latest version at https://nodejs.org/

> ant-design-pro@4.0.0 fetch:blocks G:\react\ant-design-pro
> pro fetch-blocks --branch=umi@3 && npm run prettier

- ğŸ§  find config.ts ...
âˆš ğŸ§  find config.ts ...
ğŸ“¦  install login  to: /user/login
- ğŸ˜  Parse url and args
âˆš ğŸ˜  Parse url and args
- ğŸ”  clone git repo from https://gitee.com/ant-design/pro-blocks.git
Cloning into 'github.com/ant-design/pro-blocks'...
âˆš ğŸ”  clone git repo from https://gitee.com/ant-design/pro-blocks.git
- ğŸ“¦  install dependencies package
âˆš ğŸ“¦  install dependencies package
- ğŸ”¥  Generate files
âˆš ğŸ”¥  Generate files
- â›±  Write route /user/login to config/config.ts
âˆš â›±  Write route /user/login to config/config.ts
âˆš  success   âœ¨  Probable url http://localhost:8000/user/login (copied to clipboard) for view the block.
ğŸ‘Œ  install login  to: /user/login success
ğŸ“¦  install register  to: /user/register
- ğŸ˜  Parse url and args
âˆš ğŸ˜  Parse url and args
- ğŸš›  sync file for git repo --branch umi@3
Branch umi@3 set up to track remote branch umi@3 from origin.
Switched to a new branch 'umi@3'
Already up-to-date.

###

 warning  in ./src/pages/user/register/index.tsx

"export 'router' was not found in 'umi'


è¯•ç€ä½¿ç”¨ä¸€ä¸‹ umi clean å·²ç»æ”¹æ‰äº†ï¼Œrouter è¢«åºŸå¼ƒäº†ï¼Œéœ€è¦ä½¿ç”¨ history


##  è‡ªå·±æ–°å»ºpage 

##


## new page hooks tsx


###
### å››ä¸ªæµ‹è¯•æ¡†æ¶ 

## æµ‹è¯•æ¡†æ¶

@testing-library/react-hooks  enzyme jest sinon


## test bizcharts ç¤ºä¾‹ useEffect ä¾èµ–å˜åŒ– 

### bizcharts props ä¼ é€’ æ›´æ–°æ•°æ®ä¸é‡æ–°ç»˜åˆ¶chart 
props æ”¹å˜äº† ä½†æ˜¯æ²¡é‡æ–°æ¸²æŸ“ å›¾è¡¨ ï¼Ÿ

//è¿™ä¸ªæ˜¯å­ç»„ä»¶ é€šè¿‡chart ä¼ é€’props æ¸²æŸ“
const BizChartsRows: React.FC<{}> = (props) => {
  
  //æ¥æ”¶props 
  console.log(props)
  const {dataSource} = props  //æ¥æ”¶æ•°æ®è§£è€¦

  const { DataView } = DataSet;  
  const [dv, setData] = useState(new DataView());// null é»˜è®¤å‚æ•°å¯ä»¥å—ï¼Ÿ
//   const [charts,setChartsR] = useState(dataSource) //ä¸èƒ½ç”¨è¿™ä¸ª  ç›´æ¥ç”¨props ä¼ é€’ä¸èƒ½ç”¨useState æ¥å­˜å‚¨ å¦åˆ™ä¼šæœ‰é—®é¢˜ï¼Ÿ


  const ages = [
    "Under 5 Years",
    "5 to 13 Years",
    "14 to 17 Years",
    "18 to 24 Years",
    "25 to 44 Years",
    "45 to 64 Years",
    "65 Years and Over"
  ];

  const colorMap = {
    "Under 5 Years": "#E3F4BF",
    "5 to 13 Years": "#BEF7C8",
    "14 to 17 Years": "#86E6C8",
    "18 to 24 Years": "#36CFC9",
    "25 to 44 Years": "#209BDD",
    "45 to 64 Years": "#1581E6",
    "65 Years and Over": "#0860BF"
  };
  const cols = {
    population: {
      tickInterval: 1000000
    }
  };


//https://bizcharts.net/product/bizcharts/demo/26
  useEffect(() => {
    //chart mvvm å­˜åœ¨ éœ€è¦æ”¹å˜ ?
    //ç¼–è¯‘å™¨ å¡æ­» ï¼Ÿ let ds = dv.source(charts);ds.sources(charts). ..... ä¸é‡æ–°æ¸²æŸ“
    //é‡æ–°new ä¸€ä¸ª è§£å†³æº¢å‡ºé—®é¢˜ 

        // //bug way 
    // let ds = dv.source(charts)

    //way1
    let ds = new DataView();
    ds.source(dataSource) //é‡ç‚¹
    .transform({
        type: "fold",
        fields: ages,
        key: "age",
        value: "population",
        retains: ["State"]
      })
      .transform({
        type: "map",
        callback: obj => {
          const key = obj.age;
          let type;

          if (
            key === "Under 5 Years" ||
            key === "5 to 13 Years" ||
            key === "14 to 17 Years"
          ) {
            type = "a";
          } else if (key === "18 to 24 Years") {
            type = "b";
          } else if (key === "25 to 44 Years") {
            type = "c";
          } else {
            type = "d";
          }

          obj.type = type;
          return obj;
        }
      });

    setData(ds)

  }, [props]) //é‡ç‚¹

###

##

